/* Hero Visual & Animation Styles */

.hero-visual {
  position: relative;
  width: 100%;
  max-width: 380px;
  margin: 0 auto;
  /* Aspect ratio roughly matches the CA map SVG viewBox */
  aspect-ratio: 2/3; 
  display: flex;
  align-items: center;
  justify-content: center;
}

.ca-map {
  width: 100%;
  height: 100%;
  overflow: visible;
  /* Ensure it sits behind the handshake */
  z-index: var(--z-layer-base);
  filter: drop-shadow(0 10px 20px color-mix(in srgb, var(--color-text-primary) 18%, transparent));
}

.hero-visual .ca-map path {
  fill: var(--color-on-primary);
  fill-opacity: 0.12;
  stroke: var(--color-on-primary);
  stroke-opacity: 0.55;
  stroke-width: 0.75;
  stroke-linejoin: round;
  cursor: pointer;
  transition: fill-opacity 160ms ease, stroke-opacity 160ms ease, stroke-width 160ms ease, transform 180ms ease, filter 180ms ease;
  will-change: transform, filter;
  vector-effect: non-scaling-stroke;
  /* Animation 1: Entrance */
  opacity: 0;
  transform-origin: center;
  animation: mapEntrance 0.8s ease-out forwards;
}

.hero-visual .ca-map path:hover,
.hero-visual .ca-map path:focus-visible,
.hero-visual .ca-map path.is-active {
  stroke: var(--color-accent);
  stroke-opacity: 0.95;
  stroke-width: 1.25;
  fill-opacity: 0.24;
  filter: drop-shadow(0 6px 12px color-mix(in srgb, var(--color-text-primary) 22%, transparent));
  transform: translateY(-2px) scale(1.04);
}

/* Network Nodes */
.node {
  fill: var(--color-accent);
  opacity: 0;
  animation: fadeInNodes 1s ease-out 0.8s forwards;
}

.hub-node {
  fill: var(--color-primary-strong);
  stroke: var(--color-primary);
  stroke-width: 0.5;
  opacity: 0;
  animation: fadeInNodes 1s ease-out 0.8s forwards, pulseHub 3s ease-in-out infinite 2s;
}

/* Connection Lines */
.connection-line {
  stroke: var(--color-accent);
  stroke-width: 1;
  stroke-linecap: round;
  stroke-opacity: 0;
}

/* Network Flow Animation (Step 2) */
/* Staggered pulses for lines */
.connection-line:nth-child(1) { animation: pulseLine 3s ease-in-out infinite 2.0s; }
.connection-line:nth-child(2) { animation: pulseLine 3s ease-in-out infinite 2.4s; }
.connection-line:nth-child(3) { animation: pulseLine 3s ease-in-out infinite 2.8s; }
.connection-line:nth-child(4) { animation: pulseLine 3s ease-in-out infinite 3.2s; }
.connection-line:nth-child(5) { animation: pulseLine 3s ease-in-out infinite 3.6s; }
.connection-line:nth-child(6) { animation: pulseLine 3s ease-in-out infinite 4.0s; }

/* Keyframes */

@keyframes mapEntrance {
  0% {
    opacity: 0;
    transform: scale(0.95);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes fadeInNodes {
  to { opacity: 0.6; }
}

@keyframes pulseHub {
  0%, 100% { 
    opacity: 0.8; 
    transform: scale(1);
  }
  50% { 
    opacity: 1; 
    transform: scale(1.2);
  }
}

@keyframes pulseLine {
  0% {
    stroke-opacity: 0;
    stroke-width: 1;
  }
  20% {
    stroke-opacity: 0.8;
    stroke-width: 2;
    filter: drop-shadow(0 0 2px var(--color-accent));
  }
  40% {
    stroke-opacity: 0;
    stroke-width: 1;
  }
  100% {
    stroke-opacity: 0;
  }
}

/* Reduced Motion Preference */
@media (prefers-reduced-motion: reduce) {
  .ca-map path,
  .node,
  .hub-node,
  .connection-line {
    animation: none;
    opacity: 1;
    transform: none;
    transition: none;
  }
  
  .connection-line {
    stroke-opacity: 0.2;
  }
}

/* Responsive Adjustments */
@media (min-width: 769px) {
  .hero-visual {
    max-width: 480px;
  }
}
